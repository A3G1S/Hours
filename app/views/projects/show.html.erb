<% cache @project do %>
  <div class="outer">
    <div class="container">
      <%= render partial: "project_detail", locals: { project: @project } %>

      <div class="hours-per-user-overview">
        <canvas id="hours-per-user" data-data="<%= EntryStats.new(@project.entries).hours_per(User.all).to_json %>" width="200" height="200"></canvas>
      </div>
      <ul class="legend">
        <% @project.users.each do |user| %>
        <li>
          <%= user_image_link(user, border: true) do
            content_tag(:span, "#{user.full_name} ( #{EntryStats.new(@project.entries, user).hours_spent_on} #{t(:hours)} )")
          end %>
        </li>
        <% end %>
      </ul>

      <table>
        <tbody>
          <tr>
            <th><%= t('project.table_head.tag') %></th>
            <th><%= t('project.table_head.hours') %></th>
          </tr>
          <% @project.tags.each do |tag| %>
            <tr>
              <td><%= link_to tag.name, tag_path(tag) %></td>
              <td><%= EntryStats.new(tag.entries, @project).hours_spent_on %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% end %>
